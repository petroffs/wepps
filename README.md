# Wepps - платформа для построения веб-проектов

Wepps - Платформа для построения веб-проектов. Позволяет создать сайт или restapi-проект. Гибкие настройки для упорядочивания, логирования, управления данными. Сочетает в себе CMS м PHP-framework. Тестируется на последних версиях PHP, MySQL. В базовой версии релиза созданы нескольо веб-страниц с разлчиной тестовой информацией - для наглядного примера работы.

Данный документ не завершен.

**ПО**
- Apache (для релиза необходим отдельный хост)
- PHP (7.4+, рекомендуется PHP-fpm, проект тестировался на версии 8.4)
- MySQL (5.7+, проект тестировался на версии 8.0)

**PHP- и Apache-модули**

```
$ sudo apt install php8.4-{curl,xml,mbstring,zip,pdo,gd,memcached} && sudo service php8.4-fpm restart
$ sudo a2enmod rewrite && sudo service apache2 restart
```

# install

Шаги установки
- Настройте хост на сервере apache2
- В корень сайта скопируйте последнюю версию релиза Wepps-платформы
- Распакуйте архив, и отредактируйте файлы config.php и config.cnf

> Файл config.cnf настоятельно рекомендуем вынести за пределы папки хоста.

- Перейдите в корневую папку проекта и выполните команду

```
$ php install.php
```

- Система предложит выполнить команду для загрузки composer-зависимостей, если они не загружены, затем опять предложит выполнить $ php install.php

```
cd //var/www/site/packages && php composer.phar self-update && php composer.phar install && cd ../
```

- Установщик запросит установку логина и пароля администратора

В результате выполнения произойдет следующее:

1. Загрузятся composer-зависимости
2. Заполнится база данных таблицами

# update

> Обновление платформы рекомендуется делать после сохранения бекапов файлов и базы данных

Отобразить текущую версию Wepps-платформы

```
$ php /var/www/site/packages/WeppsAdmin/Updates/Request.php version
```

Отобразить список измененных файлов, которые могут быть в поставке обновления.
Эти файлы будут запрещены к обновлению.

```
$ php /var/www/site/packages/WeppsAdmin/Updates/Request.php modified
```

Список достуных обновлений. Обновления будут устанавливаться только на более свежую версию. Вниз не обновится.

```
$ php /var/www/site/packages/WeppsAdmin/Updates/Request.php list
```

Обновление Wepps-платформы. [tag] - версия для обновления, ее можно узнать из предыдущей команды. При запуске будет список файлов к обновлению, список таблиц к обновлению. Для подтверждения обновления следует написать "yes" в вопросе, который появится.
При этом в папке /packages/WeppsAdmin/Updates/files/updates/[tag] появится несколько файлов
1. log.conf (указание запрещенных и разрешенных файлов в обновлении)
2. log-db.conf (указание запрещенных и разрешенных таблиц бд и столбцов в обновлении)
3. wepps.platform-diff.zip (файлы которые записали из обновления)
4. wepps.platform-rollback.zip (файлы которые перезаписались обновлением)
5. wepps.platform-updates.zip (все файлы обновления)

```
$ php /var/www/site/packages/WeppsAdmin/Updates/Request.php update [tag]
```